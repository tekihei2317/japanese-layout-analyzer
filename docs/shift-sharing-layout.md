# シフトと句読点を共有している配列の扱いについて

シフトキーを句読点などの文字を兼用している配列があります。

これらの配列では、句読点を入力するためにはシフト機能が働かないように、あらかじめ変換や確定を行う必要があります。

## シフトキー兼用配列

### 前置シフト: ハイブリッド月配列、ブリ中トロ配列

kが読点と前置シフト、dが句点と前置シフトを兼用しています。

句読点を入力するためには、句読点の後に変換を行うか、Enterで確定する必要があります。

### 後置シフト: 月見草配列

eが読点と後置シフトと小書き「ゃ」、fが句点と後置シフトと小書き「ゅ」を兼用しています。

句読点を入力するためには、句読点を打つ前に変換か確定をする必要があります。文頭は後置シフトでも「ゃゅょ」も打たないので、句読点と判断できるからです。

## ストロークに変換する際にどうするか

次の2点を考慮する必要があります。

1. 変換または確定を1打鍵としてカウントするか。また、どのキーとしてカウントするか。
2. 変換や確定の操作をストロークの文字列としてどう表すか。指標としてどう評価するか。

### 1について

これらの変換に関する制約で、打鍵数が増える人も、打鍵数が変わらない人も考えられます。

打鍵数が変わらない場合は、句読点で毎回変換あるいは確定を行なっている場合です。

打鍵数が増える場合は、句読点で毎回変換を行うわけではない場合、Mac等でライブ変換を使っている場合があります。

その他に、Google日本語入力の句読点変換と併用しにくい問題もありそうです。

[月見草配列v2](https://mentaiko.syoyu.net/tsukimisou)のヒートマップでは、スペースキー（親指）にカウントしています。

個人的にはライブ変換を使いつつも確定は頻繁にしているので打鍵数はほぼ変わらなさそうですが、月見草配列の例にならってスペースキーに1打鍵加算することにします。

### 2について

打鍵列としては、`konnnitiha. `のようにスペースで変換が必要なことを表します。

前置シフトの配列では句読点の後、後置シフトの配列では句読点の前にこの動作を行います。

指標としては、打鍵数としては数えます。その他の2-gramと3-gramの指標については、親指は計算に含めていないので除外して計算します。
